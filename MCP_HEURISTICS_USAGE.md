# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ MCP —Å —ç–≤—Ä–∏—Å—Ç–∏–∫–∞–º–∏ (–±–µ–∑ LLM)

## ‚úÖ –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞

MCP —Å —ç–≤—Ä–∏—Å—Ç–∏–∫–∞–º–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –∏ –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é. –ù–µ —Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (Ollama, OpenAI, Anthropic).

## üöÄ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –®–∞–≥ 1: –ù–∞—Å—Ç—Ä–æ–π—Ç–µ config.yaml

```yaml
retrieval:
  enabled: true
  use_mcp: true  # –í–∫–ª—é—á–∏—Ç—å MCP
  # mcp_provider –º–æ–∂–Ω–æ –Ω–µ —É–∫–∞–∑—ã–≤–∞—Ç—å - –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —ç–≤—Ä–∏—Å—Ç–∏–∫–∏
  # –∏–ª–∏ —É–∫–∞–∂–∏—Ç–µ "heuristics" —è–≤–Ω–æ:
  mcp_provider: "heuristics"  # –∏–ª–∏ –æ—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º/–Ω–µ —É–∫–∞–∑—ã–≤–∞–π—Ç–µ
```

### –®–∞–≥ 2: –ó–∞–ø—É—Å—Ç–∏—Ç–µ evaluation

```bash
python -m locobench.cli evaluate \
    --scenarios data/output/scenarios/test_easy_scenario.json \
    --config config.yaml
```

MCP –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —ç–≤—Ä–∏—Å—Ç–∏–∫–∏ (–±–µ–∑ LLM)
- ‚úÖ –í—ã–±–∏—Ä–∞–µ—Ç —Ñ–∞–π–ª—ã —á–µ—Ä–µ–∑ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ tools
- ‚úÖ Fallback –Ω–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π retrieval –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

## üîß –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ü—Ä–æ—Ü–µ—Å—Å —Ä–∞–±–æ—Ç—ã:

1. **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ –∑–∞–¥–∞—á–∏** - —Å–∏—Å—Ç–µ–º–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏—é (security_analysis, architectural_understanding, etc.)

2. **–°–æ–∑–¥–∞–Ω–∏–µ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö tools** - –¥–ª—è –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ tools:
   - Security Analysis ‚Üí `find_security_sensitive_files`, `analyze_dependency_graph_for_security`, `find_input_validation_points`
   - Architectural Understanding ‚Üí `identify_core_components`, `map_dependency_hierarchy`, `find_design_patterns`
   - –ò —Ç.–¥.

3. **–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ tools —Å —ç–≤—Ä–∏—Å—Ç–∏–∫–∞–º–∏**:
   - –ò–∑–≤–ª–µ–∫–∞—é—Ç—Å—è –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ –∏–∑ –∑–∞–¥–∞—á–∏
   - –ö–∞–∂–¥—ã–π tool –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Å –±–∞–∑–æ–≤—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
   - Tools –∏—â—É—Ç —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ —Ñ–∞–π–ª—ã –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º –∏ –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º

4. **–û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤**:
   - –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ—Ç –≤—Å–µ—Ö tools –æ–±—ä–µ–¥–∏–Ω—è—é—Ç—Å—è
   - –î–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è –ø–æ –ø—É—Ç–∏ —Ñ–∞–π–ª–∞
   - –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ relevance_score

5. **–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞**:
   - –í—ã–±—Ä–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã —Ñ–æ—Ä–º–∞—Ç–∏—Ä—É—é—Ç—Å—è –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç
   - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è —Å—Ç—Ä–æ–∫–∞ —Å –∫–æ–¥–æ–º —Ñ–∞–π–ª–æ–≤

## üìä –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —ç–≤—Ä–∏—Å—Ç–∏–∫

‚úÖ **–ù–µ —Ç—Ä–µ–±—É–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π** - —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ Ollama, OpenAI, Anthropic
‚úÖ **–ë—ã—Å—Ç—Ä–æ** - –Ω–µ—Ç –∑–∞–¥–µ—Ä–∂–µ–∫ –Ω–∞ –≤—ã–∑–æ–≤—ã LLM API
‚úÖ **–ë–µ—Å–ø–ª–∞—Ç–Ω–æ** - –Ω–µ—Ç –∑–∞—Ç—Ä–∞—Ç –Ω–∞ API –≤—ã–∑–æ–≤—ã
‚úÖ **–ù–∞–¥–µ–∂–Ω–æ** - –Ω–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤–Ω–µ—à–Ω–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
‚úÖ **–°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–æ** - —Ä–∞–∑–Ω—ã–µ tools –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –∑–∞–¥–∞—á

## üéØ –û–∂–∏–¥–∞–µ–º—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

–≠–≤—Ä–∏—Å—Ç–∏–∫–∏ –¥–æ–ª–∂–Ω—ã –¥–∞—Ç—å —É–ª—É—á—à–µ–Ω–∏–µ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º retrieval:

- **–ë–æ–ª–µ–µ —Ç–æ—á–Ω—ã–π –≤—ã–±–æ—Ä —Ñ–∞–π–ª–æ–≤** - —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ tools –∑–Ω–∞—é—Ç, —á—Ç–æ –∏—Å–∫–∞—Ç—å
- **–õ—É—á—à–µ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ** - –Ω–µ—Å–∫–æ–ª—å–∫–æ tools –Ω–∞—Ö–æ–¥—è—Ç —Ä–∞–∑–Ω—ã–µ –∞—Å–ø–µ–∫—Ç—ã
- **–†–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å** - —Ñ–∞–π–ª—ã –≤—ã–±–∏—Ä–∞—é—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–∏–ø–∞ –∑–∞–¥–∞—á–∏

## üìù –ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:

```yaml
retrieval:
  enabled: true
  use_mcp: true
```

### –ü–æ–ª–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:

```yaml
retrieval:
  enabled: true
  use_mcp: true
  mcp_provider: "heuristics"  # –Ø–≤–Ω–æ —É–∫–∞–∑–∞—Ç—å —ç–≤—Ä–∏—Å—Ç–∏–∫–∏
  # –û—Å—Ç–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–∞–∫ –æ–±—ã—á–Ω–æ
  top_percent: 0.05
  method: "embedding"
  model_name: "all-MiniLM-L6-v2"
```

## üîç –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ MCP —Å —ç–≤—Ä–∏—Å—Ç–∏–∫–∞–º–∏ –≤—ã —É–≤–∏–¥–∏—Ç–µ –≤ –ª–æ–≥–∞—Ö:

```
INFO: üîß Using MCP-based retrieval (provider=heuristics, use_llm=False)
INFO: üìã Created MCP server with 3 tools
INFO: ‚úÖ Tool 'find_security_sensitive_files': found 2 files
INFO: ‚úÖ Tool 'analyze_dependency_graph_for_security': found 1 files
INFO: ‚úÖ Selected 3 unique files from 3 total results
INFO: ‚úÖ MCP heuristics retrieval returned 1234 characters
```

## üÜö –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å LLM

| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ | –≠–≤—Ä–∏—Å—Ç–∏–∫–∏ | –° LLM |
|----------------|-----------|-------|
| –°–∫–æ—Ä–æ—Å—Ç—å | ‚ö° –ë—ã—Å—Ç—Ä–æ | üêå –ú–µ–¥–ª–µ–Ω–Ω–µ–µ |
| –¢–æ—á–Ω–æ—Å—Ç—å | ‚≠ê –•–æ—Ä–æ—à–∞—è | ‚≠ê‚≠ê‚≠ê –û—Ç–ª–∏—á–Ω–∞—è |
| –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ | ‚úÖ –ù–µ—Ç | ‚ùå –ù—É–∂–Ω—ã |
| –°—Ç–æ–∏–º–æ—Å—Ç—å | ‚úÖ –ë–µ—Å–ø–ª–∞—Ç–Ω–æ | üí∞ –ü–ª–∞—Ç–Ω–æ (cloud) |
| –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å | ‚úÖ –í—ã—Å–æ–∫–∞—è | ‚ö†Ô∏è –ó–∞–≤–∏—Å–∏—Ç –æ—Ç API |

## üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–ù–∞—á–Ω–∏—Ç–µ —Å —ç–≤—Ä–∏—Å—Ç–∏–∫** - —ç—Ç–æ —É–∂–µ –¥–æ–ª–∂–Ω–æ –¥–∞—Ç—å —É–ª—É—á—à–µ–Ω–∏–µ
2. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏—è—Ö** - —Å—Ä–∞–≤–Ω–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
3. **–ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –¥–æ–±–∞–≤—å—Ç–µ LLM** - –¥–ª—è –µ—â–µ –ª—É—á—à–∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

## üêõ Troubleshooting

### MCP –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
- `use_mcp: true` –≤ config.yaml
- `task_category` –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ retrieval
- `project_dir` —É–∫–∞–∑–∞–Ω

### –ü—É—Å—Ç–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ –æ—à–∏–±–∫–∏
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `context_files` –Ω–µ –ø—É—Å—Ç
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ tools –Ω–∞—Ö–æ–¥—è—Ç —Ñ–∞–π–ª—ã

### Fallback –Ω–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π retrieval

–≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ - —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ fallback –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö MCP.

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

- `MCP_EXPLANATION_RU.md` - –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–π MCP
- `MCP_INTEGRATION_GUIDE.md` - –ü–æ–¥—Ä–æ–±–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ
- `NEXT_STEPS.md` - –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

## ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!

–ü—Ä–æ—Å—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `use_mcp: true` –≤ config.yaml –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ evaluation. MCP —Å —ç–≤—Ä–∏—Å—Ç–∏–∫–∞–º–∏ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏!
