# План реализации улучшений ритривера для достижения 2.3+

## Текущая проблема
Ритривер работает как "тупая обрезка" - просто берет топ-N файлов по similarity, не используя продвинутые техники RAG.

## Приоритетные методы для быстрой реализации

### 1. QUERY EXPANSION (Быстро, высокий эффект)
**Проблема**: Текущий запрос может быть слишком узким
**Решение**: Расширить запрос синонимами и связанными терминами
**Ожидаемый эффект**: +0.05-0.10 балла

### 2. RE-RANKING С CROSS-ENCODER (Средняя сложность, высокий эффект)
**Проблема**: Bi-encoder может пропускать важные файлы
**Решение**: Переранжировать топ результаты с более мощной моделью
**Ожидаемый эффект**: +0.10-0.15 балла

### 3. GRAPH-BASED EXPANSION (Расширить существующий)
**Проблема**: Текущий граф зависимостей используется недостаточно
**Решение**: Расширить поиск через граф на 2-3 уровня глубины
**Ожидаемый эффект**: +0.08-0.12 балла

### 4. MULTI-QUERY RETRIEVAL (Быстро, средний эффект)
**Проблема**: Один запрос может не покрыть все аспекты задачи
**Решение**: Генерировать несколько вариантов запроса и объединять результаты
**Ожидаемый эффект**: +0.05-0.08 балла

### 5. HYBRID SEARCH (Semantic + Keyword) (Средняя сложность)
**Проблема**: Только семантический поиск может пропускать точные совпадения
**Решение**: Комбинировать semantic search с keyword matching (BM25)
**Ожидаемый эффект**: +0.05-0.08 балла

### 6. BETTER PROMPT ENGINEERING (Быстро, средний эффект)
**Проблема**: Используется весь промпт задачи, который может содержать шум
**Решение**: Извлекать ключевые сущности, действия, концепции для ритривера
**Ожидаемый эффект**: +0.05-0.08 балла

## Рекомендуемый порядок реализации

**Этап 1 (Быстрый результат, 1-2 часа):**
1. Query Expansion
2. Better Prompt Engineering
3. Улучшить Graph-Based Expansion

**Этап 2 (Средний результат, 3-4 часа):**
4. Multi-Query Retrieval
5. Hybrid Search (если есть библиотека для BM25)

**Этап 3 (Максимальный результат, 1 день):**
6. Re-ranking с Cross-Encoder

## Ожидаемый суммарный эффект
Этап 1: +0.18-0.30 балла → Total Score: 2.28-2.40 ✅
Этап 2: +0.10-0.16 балла → Total Score: 2.38-2.56 ✅
Этап 3: +0.10-0.15 балла → Total Score: 2.48-2.71 ✅
